window.Prime={};
(function(){function p(d,a,c,g){var h=1,k=0,j=1,l=1,e=1,m=1,q=!1;this.kill=function(){return q};this.next_step=function(r){var f;a:{f=j;var p=Math.ceil(Math.sqrt(f));if(!(f&1)&&2!=f||1==f)f=!1;else{for(var n=3;n<=p;n+=2)if(0==f%n){f=!1;break a}f=!0}}f&&(d>-c&&d<b.CANVAS_WIDTH&&a>-c&&a<b.CANVAS_HEIGHT)&&(r.fillStyle=g,r.fillRect(d,a,c,c));d+=h*c;a+=k*c;j++;e--;0==m&&(m=2,l++);0==e&&(0==h?(h=k,k=0):(k=-h,h=0),e=l,m--);j>b.MAX_COUNT&&(q=!0)}}var b={FPS:60,FRAME_MAX:30,CANVAS_WIDTH:1024,CANVAS_HEIGHT:640,
SPEED_SLIDER_MAX:1E3,MAX_COUNT:1024E4};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d){window.setTimeout(d,1E3/b.FPS)};(new function(){function d(){window.requestAnimFrame(d);for(var e=Date.now(),m=0;Date.now()-e<k&&(j==b.SPEED_SLIDER_MAX||m++<j);)for(var a in g)g[a].next_step(c),g[a].kill()&&delete g[a]}var a,c,g={},h=0,k=1E3/b.FPS,j=100,l=2;this.initialize=
function(){$(document).ready(function(){b.CANVAS_WIDTH=window.screen.availWidth;b.CANVAS_HEIGHT=window.screen.availHeight-100;a=$("<canvas id='main_canvas' width='"+b.CANVAS_WIDTH+"' height='"+b.CANVAS_HEIGHT+"'>Update your browser</canvas>");c=a.get(0).getContext("2d");$("<table id='table'><tbody><tr id='row_1'></tr><tr id='row_2'></tr></tbody></table>").appendTo("body");$("<td><button name='Clear' type='button' onclick='Prime.clear()'>Clear</button></td><td><div id='slider_dot_size'></div></td><td><div id='slider_speed'></div></td>").appendTo("#row_1");
$("<td></td><td id='dot_size'>Dot size</td><td id='speed'>Draw speed</td>").appendTo("#row_2");$("<h1>Click anywhere below to generate <a href='http://en.wikipedia.org/wiki/Ulam_spiral'>Ulam spirals</a>.</h1>").appendTo("body");a.appendTo("body");$("#main_canvas").click(function(e){var a=e.pageX-this.offsetLeft;e=e.pageY-this.offsetTop;g[h++]=new p(a,e,l,"black")});window.Prime.clear=function(){for(var a in g)delete g[a];h=0;c.fillStyle="white";c.fillRect(0,0,b.CANVAS_WIDTH,b.CANVAS_HEIGHT)};$(function(){$("#slider_dot_size").slider({max:10,
min:1,value:l})});$("#slider_dot_size").on("slidechange",function(a,b){l=b.value});$(function(){$("#slider_speed").slider({max:b.SPEED_SLIDER_MAX,min:1,value:j})});$("#slider_speed").on("slidechange",function(a,b){j=b.value});d()})};return this}).initialize()})();